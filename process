# Set variables
path_to_executable="./RTXOn/bin/Debug/net6.0/RTXOn"
width=2160
height=1080
input=$1
seed=42
seq=54
rays=100
sub=1

if [ ! -d $input ]
then
    mkdir $input
fi

if [ $2 ]
then
	seed=$2
fi

if [ $3 ]
then
	seq=$3
fi

echo $seed $seq
name="$seed.$seq"

# render
$path_to_executable render --renderer pathtracer --width $width --height $height --input-file examples/$input.txt \
--png-output $input/$name.png --pfm-output $input/$name.pfm --rays $rays -s $sub --seed $seed --sequence $seq

# animate different outputs into a gif
convert -delay 50 $input/*.png $input/runs.gif

# average over the runs
$path_to_executable average $input/$seed*.pfm --png-output $input/$input_average.png